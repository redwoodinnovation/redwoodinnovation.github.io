<!DOCTYPE html>
<meta charset="utf-8">

<head>
    <script src="https://d3js.org/d3.v4.js"></script>
    <link rel="stylesheet" type="text/css" href="theme/default/style.css">
</head>

<body>
    <!-- <h1> Cornell Elementary School </h1> -->
    <div id="container">
        <div id="toggleContainer">
            <table>
                <tr>
                    <td>CO<sub>2</sub> - Level 1</td>
                    <td><label class="switch">
                            <input id="l1_toggle" type="checkbox" checked>
                            <div class="slider co2"></div>
                        </label></td>
                </tr>
                <tr>
                    <td>CO<sub>2</sub> - Level 0</td>
                    <td><label class="switch">
                            <input id="l0_toggle" type="checkbox" checked>
                            <div class="slider co2"></div>
                        </label></td>
                </tr>
                <tr>
                    <td>CO<sub>2</sub> - Crowdsense</td>
                    <td><label class="switch">
                            <input id="crowdco2_toggle" type="checkbox" checked>
                            <div class="slider co2"></div>
                        </label></td>
                </tr>
                <tr>
                    <td>kWh - 2021 Electrical</td>
                    <td><label class="switch">
                            <input id="elec_toggle" type="checkbox" checked>
                            <div class="slider elec"></div>
                        </label></td>
                </tr>
                <tr>
                    <td>gal - 2021 Water</td>
                    <td><label class="switch">
                            <input id="h20_toggle" type="checkbox" checked>
                            <div class="slider h20"></div>
                        </label></td>
                </tr>
                <tr>
                    <td>kBTU - 2021 Gas</td>
                    <td><label class="switch">
                            <input id="gas_toggle" type="checkbox" checked>
                            <div class="slider gas"></div>
                        </label></td>
                </tr>
                <tr>
                    <td>Entries</td>
                    <td><label class="switch">
                            <input id="entries_toggle" type="checkbox" checked>
                            <div class="slider co2"></div>
                        </label></td>
                </tr>
                <tr>
                    <td>Trees</td>
                    <td><label class="switch">
                            <input id="trees_toggle" type="checkbox" checked>
                            <div class="slider co2"></div>
                        </label></td>
                </tr>
            </table>
        </div>
        <div id="map">
            <svg id="my_dataviz" width="700" height="1000" style="transform: translate(0, -10%);"></svg>
            <script>
            //----------//
            // HIGHWAYS //
            //----------// 

            // Svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map, projection, and centerpoint
            var path = d3.geoPath();
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 10]);

            var data = d3.map();

            // Load external data and boot
            d3.queue()
                .defer(d3.json, "highways.geojson")
                .await(ready);

            function ready(error, topo) {

                // Draw the map
                svg.append("g")
                    .selectAll("path")
                    .data(topo.features)
                    .enter()
                    .append("path")
                    // draw each highway
                    .attr("d", d3.geoPath()
                        .projection(projection)
                    )
                    .attr("stroke", "grey")
                    .attr("stroke-width", 8)
                    .attr("fill-opacity", 0.2);
            }
            </script>
            <script>
            //--------//
            // SCHOOL //
            //--------// 

            // Svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map, projection, and centerpoint
            var path = d3.geoPath();
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 10]);

            var data = d3.map();

            // Load external data and boot
            d3.queue()
                .defer(d3.json, "school.geojson")
                .await(ready);

            function ready(error, topo) {

                // Draw the map
                svg.append("g")
                    .selectAll("path")
                    .data(topo.features)
                    .enter()
                    .append("path")
                    // draw school ground 
                    .attr("d", d3.geoPath()
                        .projection(projection)
                    )
                    .attr("stroke", "grey")
                    .attr("stroke-width", 2)
                    .attr("fill-opacity", 0);
            }
            </script>
            <script>
            //---------//
            // GROUNDS //
            //---------// 

            // Svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map, projection, and centerpoint
            var path = d3.geoPath();
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 10]);

            var data = d3.map();
            var colorScale = d3.scaleThreshold()
                .domain([99, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500])
                .range(['#000000', '#340040', '#0000b1', '#002fdd', '#008add', '#00aa88', '#00d700', '#bcff00', '#f1e700', '#ffb500', '#ff5400', '#ff0000', '#ff3882', '#ff00ff', '#fac9fa', '#ffffff']);

            // Load external data and boot
            d3.queue()
                .defer(d3.json, "grounds.geojson")
                .defer(d3.csv, "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-d_NzjzpbEVKq66-RUzki_3-oo_lPvFHGhuIrOnMY-VIigGVjP2b5OqIJcaYolE-z88vxhaOGumut/pub?gid=1809780250&single=true&output=csv", function(d) { data.set(d.SchoolGroundsName, +d.co2ppm); })
                .await(ready);

            function ready(error, topo) {

                // Draw the map
                svg.append("g")
                    .selectAll("path")
                    .data(topo.features)
                    .enter()
                    .append("path")
                    // draw each room
                    .attr("d", d3.geoPath()
                        .projection(projection)
                    )
                    .attr("stroke", "grey")
                    .attr("stroke-width", 0.5)
                    .attr("fill-opacity", 0.5)
                    .attr("fill", function(d) {
                        d.total = data.get(d.id) || 0;
                        return colorScale(d.total);
                    });
            }
            </script>
            <script>
            //-------//
            // ROOMS //
            //-------// 

            // Svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map, projection, and centerpoint
            var path = d3.geoPath();
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 10]);

            var data = d3.map();
            var colorScale = d3.scaleThreshold()
                .domain([99, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500])
                .range(['#000000', '#340040', '#0000b1', '#002fdd', '#008add', '#00aa88', '#00d700', '#bcff00', '#f1e700', '#ffb500', '#ff5400', '#ff0000', '#ff3882', '#ff00ff', '#fac9fa', '#ffffff']);

            // Load external data and boot
            d3.queue()
                .defer(d3.json, "level0.geojson")
                .defer(d3.json, "level1.geojson")
                .defer(d3.csv, "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-d_NzjzpbEVKq66-RUzki_3-oo_lPvFHGhuIrOnMY-VIigGVjP2b5OqIJcaYolE-z88vxhaOGumut/pub?gid=1809780250&single=true&output=csv", function(d) { data.set(d.RoomNumber, +d.co2ppm); })
                .await(ready);

            function ready(error, level0, level1, topo) {
                if (error) {
                    console.log(error);
                };

                // Draw Level0 map

                svg.append("g")
                    .attr("class", "level0")
                    .selectAll("path")
                    .data(level0.features)
                    .enter()
                    .append("path")
                    // draw each room
                    .attr("d", d3.geoPath()
                        .projection(projection)
                    )
                    .attr("stroke", "grey")
                    .attr("stroke-width", 0.5)
                    .attr("fill-opacity", 0.5)
                    .attr("fill", function(d) {
                        d.total = data.get(d.id) || 0;
                        return colorScale(d.total);
                    });

                // Draw Level1 map

                svg.append("g")
                    .attr("class", "level1")
                    .selectAll("path")
                    .data(level1.features)
                    .enter()
                    .append("path")
                    // draw each room
                    .attr("d", d3.geoPath()
                        .projection(projection)
                    )
                    .attr("stroke", "grey")
                    .attr("stroke-width", 0.5)
                    .attr("fill-opacity", 0.5)
                    .attr("fill", function(d) {
                        d.total = data.get(d.id) || 0;
                        return colorScale(d.total);
                    });
            }

            var l0_Checkbox = document.querySelector('input[id="l0_toggle"]');
            var l1_Checkbox = document.querySelector('input[id="l1_toggle"]');

            l0_Checkbox.onchange = function() {
                if (this.checked) {
                    d3.selectAll(".level0").attr("visibility", "visible");
                } else {
                    d3.selectAll(".level0").attr("visibility", "hidden");
                }
            };
            l1_Checkbox.onchange = function() {
                if (this.checked) {
                    d3.selectAll(".level1").attr("visibility", "visible");
                } else {
                    d3.selectAll(".level1").attr("visibility", "hidden");
                }
            };
            </script>
            <script>
            //------------------//
            // Electrical Meter //
            //------------------// 

            // The svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map and projection
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 4])

            d3.queue()
                .defer(d3.json, "grounds.geojson") 
                .defer(d3.csv, "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-d_NzjzpbEVKq66-RUzki_3-oo_lPvFHGhuIrOnMY-VIigGVjP2b5OqIJcaYolE-z88vxhaOGumut/pub?gid=1224835953&single=true&output=csv") // Location and size
                .await(ready);

            function ready(error, dataGeo, data) {

                // Add a scale for bubble size
                var size = d3.scaleSqrt()
                    .domain([1, 10000000]) // What's in the data
                    .range([2, 30]) // Size in pixel

                // Add circles:
                setTimeout(function() {
                    svg
                        .selectAll("myCircles")
                        .data(data.sort(function(a, b) { return +b.kWh - +a.kWh }).filter(function(d, i) { return i < 1000 }))
                        .enter()
                        .append("circle")
                        .attr("class", "elecmeter")
                        .attr("cx", function(d) { return projection([+d.lon, +d.lat])[0] })
                        .attr("cy", function(d) { return projection([+d.lon, +d.lat])[1] })
                        .attr("r", function(d) { return size(+d.kWh) })
                        .style("fill", "red")
                        .attr("stroke", "red")
                        .attr("stroke-width", 4)
                        .attr("fill-opacity", 0)
                }, 1000);

                var elec_Checkbox = document.querySelector('input[id="elec_toggle"]');

                elec_Checkbox.onchange = function() {
                    if (this.checked) {
                        d3.selectAll(".elecmeter").attr("visibility", "visible");
                    } else {
                        d3.selectAll(".elecmeter").attr("visibility", "hidden");
                    }
                };

                // Add legend: circles
                var valuesToShow = [500000, 10000000]
                var xCircle = 150
                var xLabel = 200
                svg
                    .selectAll("legend")
                    .data(valuesToShow)
                    .enter()
                    .append("circle")
                    .attr("cx", xCircle)
                    .attr("cy", function(d) { return height - size(d) - 2 })
                    .attr("r", function(d) { return size(d) })
                    .style("fill", "none")
                    .attr("stroke-width", 4)
                    .attr("stroke", "red")

                // Add legend: segments
                svg
                    .selectAll("legend")
                    .data(valuesToShow)
                    .enter()
                    .append("line")
                    .attr('x1', function(d) { return xCircle + size(d) })
                    .attr('x2', xLabel)
                    .attr('y1', function(d) { return height - size(d) })
                    .attr('y2', function(d) { return height - size(d) })
                    .attr('stroke', 'white')
                    .style('stroke-dasharray', ('2,2'))

                // Add legend: labels
                svg
                    .selectAll("legend")
                    .data(valuesToShow)
                    .enter()
                    .append("text")
                    .attr('x', xLabel)
                    .attr('y', function(d) { return height - size(d) })
                    .text(function(d) { return d })
                    .style("font-size", 12)
                    .attr('fill', 'white')
                    .attr('alignment-baseline', 'middle')

            }
            </script>
            <script>
            //-------------//
            // Water Meter //
            //-------------// 

            // The svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map and projection
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 4])

            d3.queue()
                .defer(d3.json, "grounds.geojson")
                .defer(d3.csv, "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-d_NzjzpbEVKq66-RUzki_3-oo_lPvFHGhuIrOnMY-VIigGVjP2b5OqIJcaYolE-z88vxhaOGumut/pub?gid=1770914976&single=true&output=csv") // Location and size
                .await(ready);

            function ready(error, dataGeo, data) {

                // Add a scale for bubble size
                var size = d3.scaleSqrt()
                    .domain([1, 2000000]) // What's in the data
                    .range([2, 30]) // Size in pixel

                // Add circles:
                setTimeout(function() {
                    svg
                        .selectAll("myCircles")
                        .data(data.sort(function(a, b) { return +b.gal - +a.gal }).filter(function(d, i) { return i < 1000 }))
                        .enter()
                        .append("circle")
                        .attr("class", "h20meter")
                        .attr("cx", function(d) { return projection([+d.lon, +d.lat])[0] })
                        .attr("cy", function(d) { return projection([+d.lon, +d.lat])[1] })
                        .attr("r", function(d) { return size(+d.gal) })
                        .style("fill", "none")
                        .attr("stroke", "blue")
                        .attr("stroke-width", 4)
                        .attr("fill-opacity", 1)
                }, 1000);

                var h20_Checkbox = document.querySelector('input[id="h20_toggle"]');

                h20_Checkbox.onchange = function() {
                    if (this.checked) {
                        d3.selectAll(".h20meter").attr("visibility", "visible");
                    } else {
                        d3.selectAll(".h20meter").attr("visibility", "hidden");
                    }
                };

                // Add legend: circles
                var valuesToShow = [100000, 2000000]
                var xCircle = 370
                var xLabel = 420
                svg
                    .selectAll("legend")
                    .data(valuesToShow)
                    .enter()
                    .append("circle")
                    .attr("cx", xCircle)
                    .attr("cy", function(d) { return height - size(d) - 2 })
                    .attr("r", function(d) { return size(d) })
                    .style("fill", "none")
                    .attr("stroke-width", 4)
                    .attr("stroke", "blue")

                // Add legend: segments
                svg
                    .selectAll("legend")
                    .data(valuesToShow)
                    .enter()
                    .append("line")
                    .attr('x1', function(d) { return xCircle + size(d) })
                    .attr('x2', xLabel)
                    .attr('y1', function(d) { return height - size(d) })
                    .attr('y2', function(d) { return height - size(d) })
                    .attr('stroke', 'white')
                    .style('stroke-dasharray', ('2,2'))

                // Add legend: labels
                svg
                    .selectAll("legend")
                    .data(valuesToShow)
                    .enter()
                    .append("text")
                    .attr('x', xLabel)
                    .attr('y', function(d) { return height - size(d) })
                    .text(function(d) { return d })
                    .style("font-size", 12)
                    .attr('fill', 'white')
                    .attr('alignment-baseline', 'middle')
            }
            </script>
            <script>
            //-----------//
            // Gas Meter //
            //-----------// 

            // The svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map and projection
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 4])

            d3.queue()
                .defer(d3.json, "grounds.geojson") 
                .defer(d3.csv, "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-d_NzjzpbEVKq66-RUzki_3-oo_lPvFHGhuIrOnMY-VIigGVjP2b5OqIJcaYolE-z88vxhaOGumut/pub?gid=1464833914&single=true&output=csv") // Location and size
                .await(ready);

            function ready(error, dataGeo, data) {

                // Add a scale for bubble size
                // var valueExtent = d3.extent(data, function(d) { return +d.kBTU; })
                var size = d3.scaleSqrt()
                    .domain([1, 100000000]) // What's in the data
                    .range([2, 30]) // Size in pixel

                // Add circles:
                setTimeout(function() {
                    svg
                        .selectAll("myCircles")
                        .data(data.sort(function(a, b) { return +b.kBTU - +a.kBTU }).filter(function(d, i) { return i < 1000 }))
                        .enter()
                        .append("circle")
                        .attr("class", "gasmeter")
                        .attr("cx", function(d) { return projection([+d.lon, +d.lat])[0] })
                        .attr("cy", function(d) { return projection([+d.lon, +d.lat])[1] })
                        .attr("r", function(d) { return size(+d.kBTU) })
                        .style("fill", "none")
                        .attr("stroke", "yellow")
                        .attr("stroke-width", 4)
                        .attr("fill-opacity", 0)
                }, 1000);

                var gas_Checkbox = document.querySelector('input[id="gas_toggle"]');

                gas_Checkbox.onchange = function() {
                    if (this.checked) {
                        d3.selectAll(".gasmeter").attr("visibility", "visible");
                    } else {
                        d3.selectAll(".gasmeter").attr("visibility", "hidden");
                    }
                };

                // Add legend: circles
                var valuesToShow = [5000000, 100000000]
                var xCircle = 580
                var xLabel = 630
                svg
                    .selectAll("legend")
                    .data(valuesToShow)
                    .enter()
                    .append("circle")
                    .attr("cx", xCircle)
                    .attr("cy", function(d) { return height - size(d) - 2 })
                    .attr("r", function(d) { return size(d) })
                    .style("fill", "none")
                    .attr("stroke-width", 4)
                    .attr("stroke", "yellow")

                // Add legend: segments
                svg
                    .selectAll("legend")
                    .data(valuesToShow)
                    .enter()
                    .append("line")
                    .attr('x1', function(d) { return xCircle + size(d) })
                    .attr('x2', xLabel)
                    .attr('y1', function(d) { return height - size(d) })
                    .attr('y2', function(d) { return height - size(d) })
                    .attr('stroke', 'white')
                    .style('stroke-dasharray', ('2,2'))

                // Add legend: labels
                svg
                    .selectAll("legend")
                    .data(valuesToShow)
                    .enter()
                    .append("text")
                    .attr('x', xLabel)
                    .attr('y', function(d) { return height - size(d) })
                    .text(function(d) { return d })
                    .style("font-size", 12)
                    .attr('fill', 'white')
                    .attr('alignment-baseline', 'middle')
            }
            </script>
            <script>
            //----------------//
            // Crowdsense CO2 //
            //----------------// 

            // The svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map and projection
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 4])

            d3.queue()
                .defer(d3.json, "grounds.geojson") // Property shape
                .defer(d3.csv, "https://docs.google.com/spreadsheets/d/e/2PACX-1vTT1AN5PpyoMPB2_IjV4RfPVRZCGMUTQN_uBEA_pgf6NbrelQ6tntjiysCeECEOoXwc5RuDyaP1DCB-/pub?gid=768142103&single=true&output=csv") // Position of circles; sensor data
                .await(ready);

            function ready(error, dataGeo, data) {

                // Create a color scale
                var color = d3.scaleThreshold()
                    .domain([99, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500])
                    .range(['#000000', '#340040', '#0000b1', '#002fdd', '#008add', '#00aa88', '#00d700', '#bcff00', '#f1e700', '#ffb500', '#ff5400', '#ff0000', '#ff3882', '#ff00ff', '#fac9fa', '#ffffff']);

                // Add circles:
                setTimeout(function() {
                    svg
                        .selectAll("myCircles")
                        .data(data.sort(function(a, b) { return +b.CO2ppm - +a.CO2ppm }).filter(function(d, i) { return i < 10 }))
                        .enter()
                        .append("circle")
                        .attr("cx", function(d) { return projection([+d.lon, +d.lat])[0] })
                        .attr("cy", function(d) { return projection([+d.lon, +d.lat])[1] })
                        .attr("r", 5)
                        .style("fill", function(d) { return color(d.CO2ppm) })
                        .attr("stroke", "black")
                        .attr("stroke-width", 0)
                        .attr("fill-opacity", .6)
                        .attr("class", "crowdco2meter")
                }, 1000);

                var crowdco2_Checkbox = document.querySelector('input[id="crowdco2_toggle"]');

                crowdco2_Checkbox.onchange = function() {
                    if (this.checked) {
                        d3.selectAll(".crowdco2meter").attr("visibility", "visible");
                    } else {
                        d3.selectAll(".crowdco2meter").attr("visibility", "hidden");
                    }
                };

            }
            </script>
            <script>
            //---------------//
            // ENTRANCE-EXIT //
            //---------------// 

            // The svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map and projection
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 4])

            d3.queue()
                .defer(d3.json, "grounds.geojson") 
                .defer(d3.csv, "entrance-exit.csv") // Locations 
                .await(ready);

            function ready(error, dataGeo, data) {

                // Add circles:
                setTimeout(function() {
                    svg
                        .selectAll("myCircles")
                        .data(data.sort(function(a, b) { return +b.id - +a.id }).filter(function(d, i) { return i < 10 }))
                        .enter()
                        .append("circle")
                        .attr("class", "entries")
                        .attr("cx", function(d) { return projection([+d.longitude, +d.latitude])[0] })
                        .attr("cy", function(d) { return projection([+d.longitude, +d.latitude])[1] })
                        .attr("r", 8)
                        .style("fill", "blue")
                        .attr("stroke", "black")
                        .attr("stroke-width", 1)
                        .attr("fill-opacity", .5)
                }, 1500);

                var entries_Checkbox = document.querySelector('input[id="entries_toggle"]');

                entries_Checkbox.onchange = function() {
                    if (this.checked) {
                        d3.selectAll(".entries").attr("visibility", "visible");
                    } else {
                        d3.selectAll(".entries").attr("visibility", "hidden");
                    }
                };

            }
            
            </script>
            <script>
            //------//
            // TREE //
            //------// 

            // The svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map and projection
            var projection = d3.geoMercator()
                .scale(21000000) // Zoom
                .center([-122.29576905, 37.890256]) // Geolocated centerpoint
                .translate([width / 3, height / 4])

            d3.queue()
                .defer(d3.json, "grounds.geojson") 
                .defer(d3.csv, "tree.csv") // Locations 
                .await(ready);

            function ready(error, dataGeo, data) {

                // Add circles:
                setTimeout(function() {
                    svg
                        .selectAll("myCircles")
                        .data(data.sort(function(a, b) { return +b.id - +a.id }).filter(function(d, i) { return i < 10 }))
                        .enter()
                        .append("circle")
                        .attr("class", "trees")
                        .attr("cx", function(d) { return projection([+d.longitude, +d.latitude])[0] })
                        .attr("cy", function(d) { return projection([+d.longitude, +d.latitude])[1] })
                        .attr("r", 8)
                        .style("fill", "green")
                        .attr("stroke", "black")
                        .attr("stroke-width", 1)
                        .attr("fill-opacity", .5)
                }, 1000);

                var entries_Checkbox = document.querySelector('input[id="trees_toggle"]');

                entries_Checkbox.onchange = function() {
                    if (this.checked) {
                        d3.selectAll(".trees").attr("visibility", "visible");
                    } else {
                        d3.selectAll(".trees").attr("visibility", "hidden");
                    }
                };

            }
            </script>
            
            
        </div>
    </div>
    <!-- CO2 Gradient Key -->
    <div id="gradient">
        <svg width="600" height="92.26" clip-rule="evenodd" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" version="1.1" viewBox="0 0 900 92.26" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" style="transform: translate(0, -180%);">
            <g transform="matrix(.080736 0 0 .074478 -75.283 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#870098" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 -17.175 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#0000b1" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 40.933 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#002fdd" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 99.042 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#008add" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 157.15 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#00aa88" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 215.26 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#00d700" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 273.37 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#bcff00" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 331.47 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#f1e700" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 389.58 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#ffb500" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 447.69 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#ff1500" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 505.8 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#ff1736" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 563.91 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#ff3882" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 622.01 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#ff00ff" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 680.12 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#fac9fa" fill-opacity=".5" />
            </g>
            <g transform="matrix(.080736 0 0 .074478 738.23 -331.99)">
                <rect x="1180.2" y="4792.8" width="575.78" height="624.17" fill="#ffffff" fill-opacity=".5" />
            </g>
            <g transform="matrix(.19679 0 0 .19679 -198.01 -802.58)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">100</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 -198.34 -880.27)" fill="#ffffff" font-size="100px">
                <text x="1144.76" y="4545.8599" font-family="Arial-BoldMT, Arial, sans-serif" font-weight="700">CO</text>
                <text x="1294.76" y="4545.8599" font-family="LucidaGrande-Bold, 'Lucida Grande', sans-serif" font-weight="600">₂</text>
                <text x="1370.74" y="4545.8599" font-family="Arial-BoldMT, Arial, sans-serif" font-weight="700">PPM</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 -139.4 -802.58)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">200</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 -81.802 -802.58)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">300</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 -23.885 -802.58)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">400</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 33.907 -802.58)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">500</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 91.973 -802.58)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">600</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 150.27 -802.58)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">700</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 208.34 -802.58)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">800</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 266.29 -802.59)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">900</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 318.48 -802.59)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">1000</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 376.26 -802.59)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">1<tspan x="1194.86 1250.47" y="4545.8599 4545.8599">10</tspan>0</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 434.05 -802.59)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">1200</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 492.78 -802.57)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">1300</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 550.78 -802.59)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">1400</text>
            </g>
            <g transform="matrix(.19679 0 0 .19679 609.92 -802.59)">
                <text x="1144.76" y="4545.8599" fill="#ffffff" font-family="Arial-BoldMT, Arial, sans-serif" font-size="100px" font-weight="700">1500</text>
            </g>
        </svg>
       </div>
        <iframe src="https://docs.google.com/spreadsheets/d/1LAOdb-N3kTR97rE1fF7k4dGDyB9jhhNuM-PmiYYi3wo/gviz/tq?tqx=out:html&tq&gid=1180288724" height="220" width="260" style="background
        color: black; transform: translate(175%, -515%); border: 0px;"></iframe>
</body>

