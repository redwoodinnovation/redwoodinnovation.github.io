# Albany-Berkeley, California https://redwoodinnovation.github.io/albany-berkeley/

A dynamic GitHub ventilation prediction webpage displaying: 2022-12-14 16:00:00 (dynamism locked)

- Purple bounding boxes are areas of interest

- Polygons (areas) may dynamically change color and opacity per the CO2 color gradient in response to changes in "Room Sensors" (shown only at closer zoom levels) or "Picarro 4PM" (grey outlines on map) Google Sheet values.

- Circles (nodes) show color and opacity per the CO2 color gradient of individual entries in the "CO2 Crowdsense (Responses)" Google Sheet.  

## CO2 Sensor Data

- The Open Street Map school grounds (amenity=school) (grey outine) polygon dynamically displays the outside CO2 value (Picarro 4PM) per the CO2 color gradient. Data from 4pm, two days ago, is pulled into a Google Sheet via Google Apps Script each morning between 9 and 10 AM. Thease data are are stored in the "[Picarro 4PM](https://docs.google.com/spreadsheets/d/e/2PACX-1vT7Pfesayb3ZWqTwZC_tRmkTd_Q4xOb1LEumaloOSByqkxR_bCY5duYzvVfn8DuupaORpeKQ64zHzHR/pubhtml)" Google Sheet.

- CO2 - Level 0 & Level 1 ppm values are shown per room polygon and are manually entered in the "[Cornell Room Sensors](https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-d_NzjzpbEVKq66-RUzki_3-oo_lPvFHGhuIrOnMY-VIigGVjP2b5OqIJcaYolE-z88vxhaOGumut/pubhtml?gid=1809780250&single=true)" Google Sheet. Fixed room sensor data may be at an hourly interval or reported as a max daily, weekly, or monthly value. 

- CO2 - Crowdsense mobile CO2 ppm values are entered with the "CO2 Crowdsense" Google Form wherein participants enter longitude, latitude, Level, and Room # (when applicable), and are stored in the "[CO2 Crowdsense (Responses)](https://docs.google.com/spreadsheets/d/e/2PACX-1vTT1AN5PpyoMPB2_IjV4RfPVRZCGMUTQN_uBEA_pgf6NbrelQ6tntjiysCeECEOoXwc5RuDyaP1DCB-/pubhtml?gid=768142103&single=true)" Google Sheet.

- Indoor / Outdoor Max CO2 Differential, Mean Minimum CO2 Indoor, & Ventilation Prediction values are calculated in the [Max CO2 two days ago](https://docs.google.com/spreadsheets/d/12QYvKsT0-vRnczJy0BhiOgzXRP7k7jFa4jGETXVmerg/edit?usp=sharing) Google Sheet. This data is combined with the Supersite MET 4PM data to form a table (see below).

- Supersite MET 4PM environmental data (Pressure, Rainfall, Relative Humidity, Tempurature, Wind Direction, & Wind Speed) are pulled into a Google Sheet via Google Apps Script each day. These data are stored in the "[MET 4PM](https://docs.google.com/spreadsheets/d/1LAOdb-N3kTR97rE1fF7k4dGDyB9jhhNuM-PmiYYi3wo/edit#gid=0)" Google Sheet and are displayed on the webpage as a table. The [Papa Parse](https://www.papaparse.com) library is used to parse the csv data which is queried from the google sheet.

## Resource Data

- Electricity (kWh), natural gas (kBTU), and water (gal) are manually entered with the "Meter Reading Form" Google Form and are displayed as a circle node which changes size.
	- Note: Hidden in the current GitHub website.

## Geometry

- Map geometry and dynamic color and opacity fills are rendered with d3.js.

- Room polygons are geojson files stored in GitHub and are tagged as Level 0 or Level 1. 

- Streets, the school grounds polygon, and school building polygons, and other OSM objects are generated by overpass api queries, converted to geojson, and stored in GitHub. The queries and subsequent conversions to geojson are called by a python script which is triggered by a GitHub Action cron schedule. In this example, the cron schedule initiates the queries every 8 hours. 

- The property line polygon is a geojson file stored in GitHub.
	- Note: Hidden in the current GitHub website.

- Tree and entrance node data are from OSM and are stored in local csv files.
	- Note: Hidden in the current GitHub website:

- CO2 PPM color gradient SVG code is generated by Inkscape. 

- Layer toggles are html + css.

## Instructions

- After customer has circled facilities, a bounding box is determined which captures the area. This bounding box is used for the overpass api queries.

![Albany School Grounds in overpass-turbo.eu](images/albany-school-grounds.png)
